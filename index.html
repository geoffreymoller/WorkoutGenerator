<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <title>Workout Generator</title>
  <meta name="description" content="Randomly generate crossfit-style workouts with just the equipment you have.">
  <meta name="author" content="@jflinter">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/wodgenerator.css">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="https://raw.github.com/jflinter/WorkoutGenerator/master/wodgenerator.js"></script>
<script src="https://raw.github.com/jflinter/WorkoutGenerator/master/exercises.js"></script>
<script src="bootstrap-modal.js"></script>
</head>
<body>
	<a href="http://github.com/jflinter/WorkoutGenerator"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://a248.e.akamai.net/camo.github.com/7afbc8b248c68eb468279e8c17986ad46549fb71/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub"></a>
  	<div class="navbar">
		<div class="navbar-inner">
			<div class="container">
				<div class="brand">Workout Generator</div>
				<ul class="nav">
					<li><a href="#infoModal" data-dismiss="modal" data-toggle="modal">About</a></li>
	      		</ul>
			</div>
		</div>
	</div>
  	<div class="container">
		<div class="page-header">
			<h1>Workout Generator</h1>
		</div>
		<div class="row">
			<div class="span4">
				<h2>Step 1</h2>
				<h3>Pick the exercises to shuffle</h3>
		  		<div id="exercises"></div>
		  	</div>
			<div class="span4">
				<h2>Step 2</h2>
				<h3>Generate your workout</h3>
				<div class='btn btn-large btn-success' id="generateWorkout" name="generateWorkout">Go!</div>
				<div id="workout_title" style="display:none">
					<h2>Your workout:</h2>
					<div id="workout_display"></div>
					<div id="button_easier" class="btn btn-info">Easier</div>
					<div id="button_harder" class="btn btn-info">Harder</div>
				</div>
			</div>
		</div>
	</div>
	<div class="modal hide fade span8" id="infoModal">
		<div class="modal-header">
		    <a class="close" data-dismiss="modal">Ã—</a>
		    <h3>Workout Generator</h3>
		  </div>
		<div class="modal-body">
			<p>
			Workout Generator gives you personalized crossfit-style workouts that only need the equipment that you have.
			Just check the boxes for exercises you'd like to include in the shuffle, click "Generate Workout",
			and scale it to a difficulty you prefer by pressing "easier" and "harder".
			</p>
		</div>
		<div class="modal-footer">
		    <a href="#" data-dismiss="modal" class="btn">Close</a>
		</div>
	</div>

<script>

for (var i = 0; i < WodGenerator.exercises.length; i++) {
	var exercise = WodGenerator.exercises[i];
	if (document.getElementsByClassName(exercise.category).length == 0) {
		var div = document.createElement("div");
		div.className = exercise.category + " exercise-container";
		var input = document.createElement("input");
		input.type = "checkbox";
		input.className = exercise.category + " main-input";
		input.checked = true;
		input.name = exercise.category;
		input.addEventListener('click', function(event) {
			checkboxes = document.getElementsByClassName(this.name);
			for (var j = 0; j < checkboxes.length; j++) {
				var checkbox = checkboxes[j];
				checkbox.checked = this.checked;
			}
		});
		var label = document.createElement('label')
		label.className = "checkbox";
		label.appendChild(document.createTextNode(exercise.category));
		label.appendChild(input);
		var child_div = document.createElement("div");
		child_div.className = exercise.category + " exercise-sub-container";
		div.appendChild(label);
		div.appendChild(child_div);
		document.getElementById('exercises').appendChild(div);
	}
	var input = document.createElement("input");
	input.type = "checkbox";
	input.className = exercise.category;
	input.checked = true;
	input.name = exercise.name;
	var label = document.createElement('label')
	label.className = "checkbox";
	label.appendChild(document.createTextNode(exercise.name));
	label.appendChild(input);
	$("."+exercise.category+" .exercise-sub-container")[0].appendChild(label);
}

Set.prototype.render = function() {
    return this.reps + " " + this.exercise.renderForLevel(this.difficultyLevel) + " ";
}

Workout.prototype.render = function() {
    var renderedWorkout = "<dl><dt>";
    if (this.workoutType == "AMRAP") {
        renderedWorkout += "As many rounds as possible in " + this.time + " minutes of: ";
    }
    else {
        renderedWorkout += this.numberOfRounds + " round" + ((this.numberOfRounds != 1) ? "s" : "") + " of: "
    }
    renderedWorkout += "</dt>";
    renderedWorkout += this.superset.render();
    renderedWorkout += "</dl>";
    return renderedWorkout;
};

document.getElementById('generateWorkout').addEventListener('click', function() {
	var exerciseNames = $.map($("input:checked").not(".main-input"), function(e) {
		return e.name;
	});
	var exercises = WodGenerator.exercises.filter(function(exercise) {
		return ($.inArray(exercise.name, exerciseNames) != -1);
	});
	WodGenerator.workout = new Workout(100, exercises);
	renderWod();
});

function renderWod() {
	var html = WodGenerator.workout.render();
	$("#workout_display").html(html);
	$("#workout_title").show();
	
}

$("#button_harder").click(function() {
	WodGenerator.workout.scaleToDifficulty(WodGenerator.workout.difficulty() * 1.1);
	renderWod();
});

$("#button_easier").click(function() {
	WodGenerator.workout.scaleToDifficulty(WodGenerator.workout.difficulty() * 0.9);
	renderWod();
});



</script>

</body>
</html>